<div ng-controller="createDashboardPageController as $" class="create-dashboard-page"
    ng-class="{'was-validated':$.form.validated}">
    <b-content-widget data-title="Create Page" data-icon="table" data-module-type="create-page"
        data-subtitle="Add or edit dashboard page" data-await-action="$.awaitAction"
        data-hide-toolbar="$.moduleType == 'dashboard-pages'" data-module="$" data-reload-method="onPageLoad"
        data-close-method="onCloseWindow">
        <!------------------------------------>
        <!--Dashboard Page-->
        <!------------------------------------>
        <div class="create-dashboard-page d-flex">
            <!------------------------------------>
            <!--Left Side-->
            <!------------------------------------>
            <div class="col-6 b-splitter border-end pe-4" ng-class="{'was-validated':$.form.validated}">
                <div class="b-field">
                    <label class="form-label">Page Parent</label>
                    <div class="b-input-group">
                        <select ng-model="$.page.ParentId" class="b-input form-select" placeholder-text-single="'None'"
                            ng-options="page.Id as page.LevelTitle for page in $.allPages" chosen
                            inherit-select-classes="true"></select>
                        <span><i class="codicon codicon-files"></i></span>
                    </div>
                </div>
                <div class="b-field">
                    <label class="form-label">Page Type</label>
                    <div class="b-input-group">
                        <select id="drpPageType" ng-model="$.page.PageType" class="b-input form-select"
                            placeholder-text-single="'Select page type'" required>
                            <option value="" disabled>Select page type</option>
                            <option ng-value="0">Standard</option>
                            <option ng-value="1">Url</option>
                            <option ng-value="2">Existing Page</option>
                        </select>
                        <span><i class="codicon codicon-browser"></i></span>
                    </div>
                </div>
                <div class="b-field">
                    <label class="form-label">Page Name</label>
                    <div class="b-input-group">
                        <input type="text" id="txtPageName" ng-model="$.page.PageName" class="b-input form-control"
                            b-custom-focus="onEditPage" autocomplete="off" placeholder="Enter page name" required />
                        <span><i class="codicon codicon-book"></i></span>
                    </div>
                    <b-field-validation rule="module" field="$.form.error.PageName" text="PageName is not valid!."
                        ng-if="$.form.error.PageName" show-example="true"></b-field-validation>
                </div>
                <div class="b-field">
                    <label class="form-label">Page Title</label>
                    <div class="b-input-group">
                        <input type="text" id="txtPageTitle" ng-model="$.page.Title" class="b-input form-control"
                            autocomplete="off" placeholder="Enter page title" required />
                        <span><i class="codicon codicon-bookmark"></i></span>
                    </div>
                </div>
                <div class="b-field" ng-if="$.page.PageType==1">
                    <label class="form-label">Url</label>
                    <div class="b-input-group">
                        <input type="text" ng-model="$.page.Url" class="b-input form-control" autocomplete="off"
                            placeholder="Enter url address" required />
                        <span><i class="codicon codicon-credit-card"></i></span>
                    </div>
                </div>
                <div class="b-field" ng-if="$.page.PageType==2">
                    <label class="form-label">Existing Page</label>
                    <div class="b-input-group">
                        <select ng-model="$.page.ExistingPageId" class="b-input form-select"
                            placeholder-text-single="'None'"
                            ng-options="page.Id as page.LevelTitle for page in $.allPages" chosen
                            inherit-select-classes="true"></select>
                        <span><i class="codicon codicon-files"></i></span>
                    </div>
                </div>
                <div class="b-field">
                    <label class="form-label d-block">Inherit Permission From Dashboard</label>
                    <label class="b-switch">
                        <input type="checkbox" ng-model="$.page.InheritPermissionFromDashboard">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="b-field" ng-if="!$.page.InheritPermissionFromDashboard">
                    <label class="form-label">Authorization View Page</label>
                    <div class="b-input-group">
                        <select ng-model="$.page.AuthorizationViewPage" class="b-input form-select"
                            ng-options="role for role in $.$rootScope.roles" chosen inherit-select-classes="true"
                            multiple placeholder-text-multiple="'Authorization view page roles'" required>
                            <option disabled></option>
                        </select>
                        <span><i class="codicon codicon-shield-lock"></i></span>
                    </div>
                </div>
            </div>
            <!------------------------------------>
            <!--Right Side-->
            <!------------------------------------>
            <div class="col-6 ps-4">
                <div class="b-field">
                    <label class="form-label d-block">Is Visible</label>
                    <label class="b-switch">
                        <input type="checkbox" ng-model="$.page.IsVisible">
                        <span class="slider"></span>
                    </label>
                </div>
                <hr>
                <!------------------------------------>
                <!--Page Module-->
                <!------------------------------------>
                <div ng-if="$.page.PageType==0">
                    <div class="b-field">
                        <label class="form-label">Module Type</label>
                        <div class="b-input-group">
                            <select id="drpModuleType" ng-model="$.page.Module.ModuleType" class="b-input form-select"
                                chosen inherit-select-classes="true" required>
                                <option value="" disabled>Select module type</option>
                                <option value="Form">Form</option>
                                <option value="List">List</option>
                                <option value="Details">Details</option>
                            </select>
                            <span><i class="codicon codicon-bookmark"></i></span>
                        </div>
                    </div>
                    <div class="b-field">
                        <label class="form-label">Module Builder Type</label>
                        <div class="b-input-group">
                            <select id="drpScenarioId" ng-model="$.page.Module.ModuleBuilderType"
                                class="b-input form-select" ng-disabled="$.running" chosen inherit-select-classes="true"
                                placeholder-text-single="'Select module builder type'" required>
                                <option ng-value="0">Form Designer</option>
                                <option ng-value="1">Html Editor</option>
                            </select>
                            <span><i class="codicon codicon-code"></i></span>
                        </div>
                    </div>
                    <div class="b-field">
                        <label class="form-label">Module Name</label>
                        <div class="b-input-group">
                            <input type="text" id="txtModuleName" class="b-input form-control"
                                ng-model="$.page.Module.ModuleName" placeholder="Enter module name" autocomplete="off"
                                required />
                            <span><i class="codicon codicon-gear"></i></span>
                        </div>
                    </div>
                    <div class="b-field">
                        <label class="form-label">Module Title</label>
                        <div class="b-input-group">
                            <input type="text" id="txtModuleTitle" class="b-input form-control"
                                ng-model="$.page.Module.ModuleTitle" placeholder="Enter module title" autocomplete="off"
                                required />
                            <span><i class="codicon codicon-gear"></i></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!------------------------------------>
        <!-- Page Data -->
        <!------------------------------------>
        <div class="b-table theme-gray mt-3">
            <div class="table-body">
                <div class="d-flex columns-name p-2">
                    <div class="col-4">Name</div>
                    <div class="col-6">Value</div>
                    <div class="col-2">
                        <i class="codicon codicon-ellipsis"></i>
                    </div>
                </div>
                <div class="d-flex table-row" ng-repeat="(key, value) in $.page.Settings">
                    <div class="col-4 my-auto">
                        <input type="text" class="b-input form-control" ng-model="key"
                            ng-blur="$.onPageDataBlur(key,value,$index)" placeholder="Enter property name" />
                    </div>
                    <div class="col-6 my-auto">
                        <input type="text" class="b-input form-control" ng-model="value"
                            ng-blur="$.onPageDataBlur(key,value,$index)" placeholder="Enter property value" />
                    </div>
                    <div class="col-2 my-auto">
                        <button type="button" class="b-btn btn-sm btn-action ms-1"
                            ng-click="$.onDeletePageDataProperty(key)">
                            <i class="codicon codicon-trash me-0"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="table-footer">
                <button type="button" class="b-btn btn-sm btn-action" b-custom-tooltip data-bs-placement="bottom"
                    title="Add Property" ng-click="$.onAddPageDataProperty()">
                    <i class="codicon codicon-plus me-0"></i>
                </button>
            </div>
        </div>
        <hr class="mb-4" />
        <div class="d-flex justify-content-start" ng-if="$.page.Modudle.Id">
            <button type="button" class="b-btn btn-sm btn-action" b-custom-tooltip title="Delete Page Module"
                ng-click="$.onDeleteModuleClick()" ng-disabled="$.running">
                <i class="codicon codicon-trash me-0" ng-class="{'loading-circle mini':$.running=='save-action'}"></i>
            </button>
            <button type="button" class="b-btn btn-sm btn-cancel me-2" b-custom-tooltip title="Goto Module Builder"
                ng-click="$.onGotoModuleBuilderClick()" ng-disabled="$.running">
                <i class="codicon codicon-preview me-0"></i>
            </button>
        </div>
        <div class="d-flex justify-content-end mt-auto">
            <button type="button" class="b-btn btn-text-icon btn-icon btn-submit me-2" ng-click="$.onSavePageClick()"
                ng-disabled="$.running">
                <i class="codicon codicon-save" ng-class="{'loading-circle mini':$.running=='save-dashboard'}"></i>
                Save Page
            </button>
            <button type="button" class="b-btn btn-text-icon btn-cancel" ng-click="$.onCancelPageClick()"
                ng-disabled="$.running">
                <i class="codicon codicon-circle-slash"></i>
                Cancel
            </button>
        </div>
    </b-content-widget>
</div>