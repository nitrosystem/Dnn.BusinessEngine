<div ng-controller="extensionsController as $" class="extensions">
    <!------------------------------------>
    <!--Sidebar-->
    <!------------------------------------>
    <div class="mb-sidebar" b-custom-sidebar="extensions">
        <!------------------------------------>
        <!--Extensions List-->
        <!------------------------------------>
        <div class="b-extensions">
            <div class="header-sections">
                <!------------------------------------>
                <!--Top Tools-->
                <!------------------------------------>
                <div class="top-tools">
                    <label class="label">Extension Marketplace</label>
                    <div class="tools-items">
                        <div class="tools-item">
                            <button type="button" ng-click="$.onFilterItemsClick()" b-custom-tooltip
                                title="Filter & Find Extensions">
                                <i class="codicon codicon-filter"></i>
                            </button>
                        </div>
                        <div class="tools-item">
                            <button type="button" ng-click="$.onRefreshItemsClick()" b-custom-tooltip
                                title="Refresh & Reload Extensions">
                                <i class="codicon codicon-refresh"></i>
                            </button>
                        </div>
                        <div class="tools-item">
                            <button type="button" ng-click="$.onFilterItemsClick()" b-custom-tooltip
                                title="More Actions">
                                <i class="codicon codicon-ellipsis"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <!------------------------------------>
                <!--Search Extensions-->
                <!------------------------------------>
                <div class="search-wrapper">
                    <div class="b-input-group">
                        <input type="text" ng-model="filter.SearchText" class="b-input"
                            placeholder="Search  & Marketplace Extensions" />
                        <span><i class="codicon codicon-search"></i></span>
                    </div>
                </div>
            </div>
            <!------------------------------------>
            <!--Extensions Online Marketplace-->
            <!------------------------------------>
            <div class="online-market-wrapper">
                <a href="https://bengine.com/extensions" target="_blank" class="online-market-button">
                    <i class="codicon codicon-package"></i> Online Marketplace
                </a>
            </div>
            <!------------------------------------>
            <!--Top & New Extensions on market place-->
            <!------------------------------------>
            <div class="extension-list">
                <!------------------------------------>
                <!--Popular Extensions-->
                <!------------------------------------>
                <div class="b-group group-sm mb-4">
                    <div class="group-header" data-bs-toggle="collapse" data-bs-target="#grpExistsExtensions">
                        <h3 class="group-label">
                            <span class="group-icon">
                                <i class="codicon codicon-server-process"></i>
                            </span> Popular Extensions
                        </h3>
                        <span class="group-collapse">
                            <i class="codicon codicon-chevron-up"></i>
                        </span>
                    </div>
                    <div id="grpExistsExtensions" class="group-content collapse show">
                        <div class="extension-items">
                            <div class="extension-item">
                                <div class="left-box">
                                    <div class="image-wrapper">
                                        <img ng-src="/DesktopModules/BusinessEngine/assets/images/nitro-I.png" />
                                    </div>
                                    <h5 class="category">Advanced Pack 1</h5>
                                </div>
                                <div class="content-wrapper">
                                    <div class="top-info">
                                        <h3 class="title">Nitro I Extensions</h3>
                                        <div class="star-wrapper">
                                            5
                                            <i class="codicon codicon-star-full"></i>
                                        </div>
                                    </div>
                                    <p class="summary">
                                        This package is the need of every application.
                                    </p>
                                    <div class="more-info">
                                        <label class="price-label">99$</label>
                                        <button type="button" class="b-btn btn-action btn-sm">Buy & Install</button>
                                    </div>
                                </div>
                            </div>
                            <div class="extension-item">
                                <div class="left-box">
                                    <div class="image-wrapper">
                                        <img ng-src="/DesktopModules/BusinessEngine/assets/images/nitro-II.png" />
                                    </div>
                                    <h5 class="category">Advanced Pack 2</h5>
                                </div>
                                <div class="content-wrapper">
                                    <div class="top-info">
                                        <h3 class="title">Nitro II Extensions</h3>
                                        <div class="star-wrapper">
                                            5
                                            <i class="codicon codicon-star-full"></i>
                                        </div>
                                    </div>
                                    <p class="summary">
                                        This extension includes advanced & professional extensions.
                                    </p>
                                    <div class="more-info">
                                        <label class="price-label">99$</label>
                                        <button type="button" class="b-btn btn-action btn-sm">Buy & Install</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!------------------------------------>
    <!--Content Panel  Extensions group by type-->
    <!------------------------------------>
    <b-content-widget data-title="Extensions" data-icon="extensions" data-module-type="extensions"
        data-subtitle="components, skins, services, actions, packages, ..." data-await-action="$.awaitAction"
        data-module="$" data-reload-method="onPageLoad" data-close-method="onCloseWindow">
        <div class="d-flex mb-4">
            <div class="col-3 me-3">
                <div class="b-input-group">
                    <input type="text" ng-model="$.filter.ExtensionName" class="b-input form-control"
                        placeholder="Search by extension name" />
                    <span><i class="codicon codicon-bell"></i></span>
                </div>
            </div>
            <div class="col-1">
                <div class="b-input-group">
                    <button type="button" class="b-input form-control ps-1" ng-click="$.onSearchClick()"
                        ng-disabled="$.running">
                        <i class="codicon codicon-search" ng-disabled="$.running"></i>
                    </button>
                </div>
            </div>
            <div class="ms-auto">
                <!------------------------------------>
                <!--Install New Extenions-->
                <!------------------------------------>
                <button type="button" class="b-btn btn-text-icon btn-submit" ng-click="$.onInstallExtensionClick()"
                    ng-disabled="$.running">
                    <i class="codicon codicon-plus" ng-disabled="$.running"></i>
                    Install New Extension
                </button>
            </div>
        </div>
        <!------------------------------------>
        <!--Available Extensions-->
        <!------------------------------------>
        <div class="b-group" ng-if="$.availableExtensions.length">
            <div class="group-header" data-bs-toggle="collapse" data-bs-target="#grpAvailableExtensions">
                <h3 class="group-label">
                    <span class="group-icon">
                        <i class="codicon codicon-server-process"></i>
                    </span>Available Extensions
                </h3>
                <span class="group-collapse">
                    <i class="codicon codicon-chevron-up"></i>
                </span>
            </div>
            <div id="grpAvailableExtensions" class="group-content collapse show">
                <div class="b-table theme-gray">
                    <div class="table-body pt-3">
                        <div class="d-flex columns-name">
                            <div class="col-1">
                                <i class="codicon codicon-extensions fs2-rem"></i>
                            </div>
                            <div class="col-8 my-auto">Extension Name</div>
                            <div class="col-2 my-auto">...</div>
                        </div>
                        <div class="d-flex table-row"
                            ng-repeat="item in $.availableExtensions | fuzzyBy: 'extensionName' : $.filter.Extension">
                            <div class="col-1 my-auto">
                                <i class="codicon codicon-extensions fs2-rem b-color-{{$index+1}}"></i>
                            </div>
                            <div class="col-8 my-auto text-light">
                                {{item}}
                            </div>
                            <div class="col-2 my-auto text-light">
                                <div class="b-btn-group">
                                    <!------------------------------------>
                                    <!--Install New Extenions-->
                                    <!------------------------------------>
                                    <button type="button" class="b-btn btn-submit"
                                        ng-click="$.onInstallAvailableExtension(item,$index)" ng-disabled="$.running">
                                        INSTALL
                                    </button>
                                    <button type="button" class="b-btn btn-submit dropdown-toggle dropdown-toggle-split"
                                        ng-disabled="$.running" data-bs-toggle="dropdown" aria-expanded="false">
                                    </button>
                                    <div class="dropdown-menu b-dropdown-menu">
                                        <a class="dropdown-item"
                                            ng-href="/DesktopModules/BusinessEngine/install/{{item}}" target="_blank">
                                            <i class="codicon codicon-cloud-download me-2"></i> Download Extension
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!------------------------------------>
        <!--Installed Extensions-->
        <!------------------------------------>
        <div class="b-group">
            <div class="group-header" data-bs-toggle="collapse" data-bs-target="#grpExtensions">
                <h3 class="group-label">
                    <span class="group-icon">
                        <i class="codicon codicon-server-process"></i>
                    </span>Installed Extensions
                </h3>
                <span class="group-collapse">
                    <i class="codicon codicon-chevron-up"></i>
                </span>
            </div>
            <div id="grpExtensions" class="group-content collapse show">
                <div class="extensions">
                    <div class="extension-item-wrapper" ng-repeat="extension in $.extensions">
                        <div class="row">
                            <div class="col-2 extension-logo-wrapper">
                                <img ng-src="{{extension.ExtensionImage}}" />
                            </div>
                            <div class="col-5 b-splitter border-end">
                                <h5 class="extension-name">{{extension.ExtensionName}}</h5>
                                <p class="text-mute mb-2">Version {{extension.Version}} </p>
                                <p class="text-mute mb-2">
                                    Install
                                    <span class="text-mute mb-1" b-custom-date="{{extension.CreatedOnDate}}"></span>
                                </p>
                                <p class="extension-desc">
                                    {{extension.Summary}}
                                </p>
                            </div>
                            <div class="col-2 b-splitter border-end small">
                                <div class="d-flex align-items-center mb-3">
                                    <i class="codicon me-2"
                                        ng-class="{'codicon-check':extension.IsCommercial,'codicon-chrome-maximize':!extension.IsCommercial}"></i>
                                    Is Commercial
                                </div>
                                <div class="d-flex align-items-center mb-3">
                                    <i class="codicon me-2"
                                        ng-class="{'codicon-check':!extension.IsCommercial,'codicon-chrome-maximize':extension.IsCommercial}"></i>
                                    Is Free
                                </div>
                                <div class="d-flex align-items-center mb-3">
                                    <i class="codicon me-2"
                                        ng-class="{'codicon-check':extension.IsOpenSource,'codicon-chrome-maximize':!extension.IsOpenSource}"></i>
                                    Is Open Source
                                </div>
                            </div>
                            <div class="col-1 action-btns">
                                <button type="button" class="b-btn btn-action mb-2"
                                    ng-click="$.onDeleteExtensionClick(extension.ExtensionID,$index)">
                                    <i class="codicon codicon-trash me-0"></i>
                                </button>
                                <a class="b-btn btn-action" href="#extensionMoreData{{extension.ExtensionID}}"
                                    data-bs-toggle="collapse" role="button" aria-expanded="false"
                                    aria-controls="multiCollapseExample1">
                                    <i class="codicon codicon-fold-down me-0"></i>
                                </a>
                            </div>
                        </div>
                        <div class="collapse multi-collapse" id="extensionMoreData{{extension.ExtensionID}}">
                            <div class="extension-options">
                                <div class="b-table">
                                    <div class="table-body">
                                        <div class="grid columns-name">
                                            <div class="g-col-1">
                                                <label class="b-checkbox">
                                                    <input type="checkbox" ng-model="$.filter.IsSelectedAll">
                                                    <i class="checkbox-icon"></i>
                                                </label>
                                            </div>
                                            <div class="g-col-1">Type</div>
                                            <div class="g-col-7">Resource Path</div>
                                            <div class="g-col-1 text-center">Prority</div>
                                            <div class="g-col-1 text-end">
                                                <i class="codicon codicon-ellipsis"></i>
                                            </div>
                                        </div>
                                        <div class="grid table-row"
                                            ng-repeat="resource in extension.Resources | orderBy: 'LoadOrder'">
                                            <div class="g-col-1">
                                                <label class="b-checkbox">
                                                    <input type="checkbox" ng-model="$.action.IsSelected">
                                                    <i class="checkbox-icon"></i>
                                                </label>
                                            </div>
                                            <div class="g-col-1">
                                                {{resource.ResourceType}}
                                            </div>
                                            <div class="g-col-7">
                                                {{resource.ResourcePath}}
                                            </div>
                                            <div class="g-col-1 text-center">
                                                {{resource.LoadOrder}}
                                            </div>
                                            <div class="g-col-1 text-end">
                                                <div class="col-1 action-btns level-2">
                                                    <button type="button" class="b-btn btn-action mb-2"
                                                        ng-click="$.onEditExtensionClick(extension.ExtensionID,extension.ExtensionName,extension.FieldID)">
                                                        <i class="codicon codicon-edit me-0"></i>
                                                    </button>
                                                    <button type="button" class="b-btn btn-action mb-2"
                                                        ng-click="$.onDeleteExtensionClick(extension.ExtensionID,$index)">
                                                        <i class="codicon codicon-trash me-0"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="table-footer">
                                        <div ng-if="!extension.Resources.length" class="b-notify notify-info mb-4">
                                            <i class="codicon codicon-info b-icon-2"></i>
                                            <div class="text">
                                                <h4 class="label">No Resources!.</h4>
                                                <span class="subtext">
                                                    No resourcefor this extensions!
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </b-content-widget>

    <!------------------------------------>
    <!--Install New Extension Panel->
    <!------------------------------------>
    <b-right-widget ng-if="$.workingMode=='install-extension'" data-title="Install New Extension Wizard"
        data-icon="extensions" data-subtitle="select and upload extension package" data-await-action="$.awaitAction"
        class="b-install-extensions-wizard" data-module="$" data-reload-method="onPageLoad"
        data-close-method="onCloseWindow">
        <!------------------------------------>
        <!--Install Wizard->
        <!------------------------------------>
        <div class="wizard-steps artin">
            <div class="wz-steps">
                <div class="wz-step" ng-class="{'disabled':$.running,'active':$.extInstalingStep==1}">
                    <span></span>Upload
                    Extension
                </div>
                <div class="wz-step" ng-class="{'disabled':$.running,'active':$.extInstalingStep==2}">
                    <span></span>Extension
                    Info
                </div>
                <div class="wz-step" ng-class="{'disabled':$.running,'active':$.extInstalingStep==3}">
                    <span></span>Install
                    Extension
                </div>
                <div class="wz-step" ng-class="{'disabled':$.running,'active':$.extInstalingStep==4}">
                    <span></span>Finish &
                    Use!
                </div>
            </div>
            <div class="step-content">
                <!--Wizard Loading-->
                <div class="pre-loader theme-default" ng-hide="$.hideStepPreloader">
                    <div class="lines"></div>
                </div>
                <!------------------------------------>
                <!--Install Progress-->
                <!------------------------------------>
                <div ng-if="$.awaitAction.showProgress" data-bs-theme="dark">
                    <div class="progress mt-2 mb-1" role="progressbar" aria-label="{{$.awaitAction.subtitle}}"
                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                        <div class="progress-bar progress-bar-striped progress-bar-animated"></div>
                    </div>
                </div>
                <!------------------------------------>
                <!--Wizard Step 1 (Select & Upload Extension File)-->
                <!------------------------------------>
                <div ng-if="$.extInstalingStep==1">
                    <div class="b-upload-box">
                        <input type="file" class="form-control" accept=".zip"
                            ngf-select="$.onUploadExtensionPackage($files,$file, $newFiles, $duplicateFiles, $invalidFiles, $event)"
                            ngf-max-size="103809024" ngf-fix-orientation="true" />
                        <p>Click to open browse files and select one zip file for install extension.</p>
                        <i class="codicon codicon-extensions"></i>
                    </div>
                    <div class="b-notify notify-info mb-4">
                        <i class="codicon codicon-shield b-icon-2"></i>
                        <div class="text">
                            <h4 class="label">Important.</h4>
                            <p class="subtext">the extension file size must be standard size that define in web.config.
                            </p>
                            <a href="#" class="card-link">More info</a>
                        </div>
                    </div>
                </div>
                <!------------------------------------>
                <!--Wizard Step 2 (Show Extension Info)-->
                <!------------------------------------>
                <div ng-if="$.extInstalingStep==2">
                    <div class="extension-details">
                        <div class="ext-row ext-splitter">
                            <div class="image-wrapper">
                                <i ng-if="!item.ExtensionImage" class="codicon codicon-extensions"></i>
                            </div>
                            <div class="extension-top-info">
                                <h1 class="ext-name">{{$.extension.ExtensionName}}</h1>
                                <h4 class="ext-title">{{$.extension.Title}}</h4>
                                <span class="ext-type">{{$.extension.ExtensionType}}</span>
                                <p class="ext-summary">
                                    {{$.extension.Summary}}
                                </p>
                            </div>
                            <div class="ext-is-commercial">
                                <p><b>Version</b> {{$.extension.Version}}</p>
                                <p><b>Folder </b> {{$.extension.FolderName}}</p>
                            </div>
                        </div>
                        <div class="ext-row ext-splitter"></div>
                    </div>
                </div>
                <!------------------------------------>
                <!--Wizard Step 3 (Install Extension)-->
                <!------------------------------------>
                <div ng-if="$.extInstalingStep==3">
                    <ul id="progressLog" class="progress-log"></ul>
                </div>
                <!------------------------------------>
                <!--Wizard Step 4 (Action Builder)-->
                <!------------------------------------>
                <div ng-show="$.extInstalingStep==4">
                    <h3 class="text-center text-success text-uppercase">Congratulations! THE EXTENSION HAS BEEN
                        INSTALLED SUCCESSFULLY.</h3>
                </div>
                <!------------------------------------>
                <!--Wizard Actoions(Buttons)-->
                <!------------------------------------>
                <hr class="mb-4" />
                <div class="d-flex mb-1">
                    <div class="justify-content-start">
                        <button type="button" class="b-btn btn-text-icon me-2"
                            ng-if="$.extInstalingStep>1 && $.extInstalingStep<4 && !$.awaitAction.isError"
                            ng-click="$.onInstallExtensionStepClick()" ng-disabled="$.running">
                            Next
                            <i class="codicon codicon-arrow-right ms-2 me-0"></i>
                        </button>
                        <button type="button" class="b-btn btn-text-icon btn-submit me-2" ng-if="$.extInstalingStep>=4"
                            ng-click="$.onDoneInstallExtensionClick()" ng-disabled="$.running">
                            <i class="codicon codicon-save"
                                ng-class="{'loading-circle mini':$.running=='save-action'}"></i>
                            Done
                        </button>
                    </div>
                    <div class="d-flex justify-content-end ms-auto">
                        <button type="button" class="b-btn btn-text-icon btn-cancel"
                            ng-click="$.onCancelInstallExtensionClick()" ng-disabled="$.running">
                            <i class="codicon codicon-circle-slash"></i>
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </b-right-widget>
</div>